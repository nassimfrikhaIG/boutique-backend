(self.webpackChunktest=self.webpackChunktest||[]).push([[173],{3173:(e,t,r)=>{"use strict";r.r(t),r.d(t,{AllProductModule:()=>v});var o=r(1116),i=r(9076),n=r(5959),s=r(6673),c=r(8277);const d=new(r(1098).v)(c.o);function a(e,t=d){return r=>r.lift(new u(e,t))}class u{constructor(e,t){this.dueTime=e,this.scheduler=t}call(e,t){return t.subscribe(new l(e,this.dueTime,this.scheduler))}}class l extends s.L{constructor(e,t,r){super(e),this.dueTime=t,this.scheduler=r,this.debouncedSubscription=null,this.lastValue=null,this.hasValue=!1}_next(e){this.clearDebounce(),this.lastValue=e,this.hasValue=!0,this.add(this.debouncedSubscription=this.scheduler.schedule(g,this.dueTime,this))}_complete(){this.debouncedNext(),this.destination.complete()}debouncedNext(){if(this.clearDebounce(),this.hasValue){const{lastValue:e}=this;this.lastValue=null,this.hasValue=!1,this.destination.next(e)}}clearDebounce(){const e=this.debouncedSubscription;null!==e&&(this.remove(e),e.unsubscribe(),this.debouncedSubscription=null)}}function g(e){e.debouncedNext()}function h(e,t){return r=>r.lift(new p(e,t))}class p{constructor(e,t){this.compare=e,this.keySelector=t}call(e,t){return t.subscribe(new Z(e,this.compare,this.keySelector))}}class Z extends s.L{constructor(e,t,r){super(e),this.keySelector=r,this.hasKey=!1,"function"==typeof t&&(this.compare=t)}compare(e,t){return e===t}_next(e){let t;try{const{keySelector:r}=this;t=r?r(e):e}catch(o){return this.destination.error(o)}let r=!1;if(this.hasKey)try{const{compare:e}=this;r=e(this.key,t)}catch(o){return this.destination.error(o)}else this.hasKey=!0;r||(this.key=t,this.destination.next(e))}}var m=r(8619),T=r(8315),A=r(1462);function f(e,t){if(1&e){const e=m.EpF();m.TgZ(0,"tr"),m.TgZ(1,"td"),m._UZ(2,"img",47),m.qZA(),m.TgZ(3,"td"),m._uU(4),m.qZA(),m.TgZ(5,"td"),m._uU(6),m.qZA(),m.TgZ(7,"td"),m._uU(8),m.qZA(),m.TgZ(9,"td"),m._uU(10),m.qZA(),m.TgZ(11,"td"),m._uU(12),m.qZA(),m.TgZ(13,"td"),m._uU(14),m.qZA(),m.TgZ(15,"td"),m._uU(16),m.qZA(),m.TgZ(17,"td"),m._uU(18),m.qZA(),m.TgZ(19,"td"),m.TgZ(20,"div",48),m.TgZ(21,"button",49),m.NdJ("click",function(){const t=m.CHM(e).$implicit;return m.oxw().getData(t.name,t.description,t.price,t.stock,null==t.category?null:t.category.name,t.image,t._id)}),m._UZ(22,"i",50),m.qZA(),m.TgZ(23,"button",51),m.NdJ("click",function(){const t=m.CHM(e).$implicit;return m.oxw().openConfirmModal(t._id)}),m._UZ(24,"i",52),m.qZA(),m.qZA(),m.qZA(),m.qZA()}if(2&e){const e=t.$implicit;m.xp6(2),m.Q6J("src",e.image,m.LSH),m.xp6(2),m.Oqu(e.name),m.xp6(2),m.Oqu(e.description),m.xp6(2),m.hij("",e.price,"DT"),m.xp6(2),m.Oqu(e.stock),m.xp6(2),m.Oqu(e.stock>0?"En Stock":"Rupture de stock"),m.xp6(2),m.Oqu(null==e.category?null:e.category.name),m.xp6(2),m.Oqu(e.createdAt),m.xp6(2),m.Oqu(e.updatedAt)}}function b(e,t){1&e&&(m.TgZ(0,"tr"),m.TgZ(1,"td",53),m._uU(2,"Aucun produit trouv\xe9"),m.qZA(),m.qZA())}function q(e,t){if(1&e&&(m.TgZ(0,"div",54),m._uU(1),m.qZA()),2&e){const e=m.oxw();m.xp6(1),m.hij(" ",e.messageSuccess," ")}}function y(e,t){if(1&e){const e=m.EpF();m.TgZ(0,"div",55),m.TgZ(1,"div",56),m.TgZ(2,"p"),m._uU(3,"Voulez-vous supprimer ce produit ?"),m.qZA(),m.TgZ(4,"div",57),m.TgZ(5,"button",58),m.NdJ("click",function(){return m.CHM(e),m.oxw().confirmDelete()}),m._uU(6,"Oui"),m.qZA(),m.TgZ(7,"button",59),m.NdJ("click",function(){return m.CHM(e),m.oxw().cancelDelete()}),m._uU(8,"Non"),m.qZA(),m.qZA(),m.qZA(),m.qZA()}}const x=[{path:"",component:(()=>{class e{constructor(e,t){this.produitService=e,this.datePipe=t,this.produits=[],this.allProduits=[],this.dataArray=[],this.searchTerm="",this.categorySearchTerm="",this.searchTerms=new n.xQ,this.categorySearchTerms=new n.xQ,this.showConfirmModal=!1,this.produitIdToDelete="",this.categories=[],this.selectedProduct={name:"",description:"",price:0,stock:0,category:{name:""},image:"",id:""},this.messageSuccess=""}ngOnInit(){this.getAllProduits(),this.getAllCategories(),this.searchTerms.pipe(a(300),h()).subscribe(e=>{this.applyFilters()}),this.categorySearchTerms.pipe(a(300),h()).subscribe(e=>{this.applyFilters()})}onSearch(e){this.searchTerm=e,this.searchTerms.next(e)}onCategorySearch(e){this.categorySearchTerm=e,this.categorySearchTerms.next(e)}applyFilters(){if(!this.searchTerm.trim()&&!this.categorySearchTerm.trim())return void(this.produits=[...this.allProduits]);let e=[...this.allProduits];this.searchTerm.trim()&&(e=e.filter(e=>e.name.toLowerCase().includes(this.searchTerm.toLowerCase()))),this.categorySearchTerm.trim()&&(e=e.filter(e=>e.category&&e.category.name.toLowerCase().includes(this.categorySearchTerm.toLowerCase()))),this.produits=e}getAllProduits(){this.produitService.getAllproduit().subscribe(e=>{this.allProduits=e.map(e=>(e.createdAt=this.datePipe.transform(e.createdAt,"dd/MM/yyyy HH:mm:ss"),e.updatedAt=this.datePipe.transform(e.updatedAt,"dd/MM/yyyy HH:mm:ss"),e)),this.produits=[...this.allProduits]},e=>{console.error("Erreur lors du chargement des produits",e)})}getAllCategories(){this.produitService.getAllcategory().subscribe(e=>{this.categories=e},e=>{console.error("Erreur lors du chargement des cat\xe9gories",e)})}deleteProduit(e){this.produitService.Deleteproduit(e).subscribe(()=>{this.getAllProduits()},e=>{console.error("Erreur lors de la suppression du produit",e)})}getData(e,t,r,o,i,n,s){this.messageSuccess="",this.selectedProduct={name:e,description:t,price:r,stock:o,category:{name:i},image:n,id:s}}updateProduct(e){this.produitService.Updateproduit(this.selectedProduct.id,e.value).subscribe(e=>{this.messageSuccess=`Le produit ${this.selectedProduct.name} a \xe9t\xe9 mis \xe0 jour avec succ\xe8s.`,this.getAllProduits(),console.log(e)},e=>{console.error("Erreur lors de la mise \xe0 jour du produit",e)})}openConfirmModal(e){this.produitIdToDelete=e,this.showConfirmModal=!0}confirmDelete(){this.deleteProduit(this.produitIdToDelete),this.showConfirmModal=!1}cancelDelete(){this.produitIdToDelete="",this.showConfirmModal=!1}}return e.\u0275fac=function(t){return new(t||e)(m.Y36(T.d),m.Y36(o.uU))},e.\u0275cmp=m.Xpm({type:e,selectors:[["app-listeproduit"]],features:[m._Bn([o.uU])],decls:94,vars:12,consts:[[1,"container-fluid"],[1,"h3","mb-4","text-gray-800"],[1,"row","mb-4"],[1,"col-md-5"],[1,"input-group"],[1,"input-group-prepend"],[1,"input-group-text"],["type","text","placeholder","Rechercher Par Produit...",1,"form-control","bg-light","border-0","small",3,"ngModel","ngModelChange","input"],[1,"input-group-append"],["type","button",1,"btn","btn-primary"],[1,"fas","fa-search","fa-sm"],["type","text","placeholder","Rechercher par cat\xe9gorie...",1,"form-control","bg-light","border-0","small",3,"ngModel","ngModelChange","input"],[1,"col-md-2"],["routerLink","/admin/addproduit",1,"btn","btn-success","w-100"],[1,"fas","fa-plus","mr-2"],[1,"card","shadow","mb-4"],[1,"card-body"],[1,"table","table-bordered"],[4,"ngFor","ngForOf"],[4,"ngIf"],["id","exampleModal","tabindex","-1","aria-labelledby","exampleModalLabel","aria-hidden","true",1,"modal","fade"],[1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],["id","exampleModalLabel",1,"modal-title"],["type","button","data-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],[1,"modal-body"],[3,"ngSubmit"],["f","ngForm"],[1,"form-group"],["for","name"],["type","text","placeholder","name","required","","minlength","2","maxlength","20","name","name","ngModel","",1,"form-control",3,"ngModel","ngModelChange"],["name","ngModel"],["for","description"],["type","text","placeholder","Description","required","","name","description","ngModel","",1,"form-control",3,"ngModel","ngModelChange"],["for","price"],["type","number","placeholder","price","required","","name","price","ngModel","",1,"form-control",3,"ngModel","ngModelChange"],["for","stock"],["type","number","placeholder","stock","required","","name","stock","ngModel","",1,"form-control",3,"ngModel","ngModelChange"],["for","category"],["type","text","name","category","ngModel","",1,"form-control",3,"ngModel","ngModelChange"],["class","alert alert-success",4,"ngIf"],[1,"btn","btn-primary",3,"disabled"],[1,"modal-footer"],["type","button","data-dismiss","modal",1,"btn","btn-secondary"],["class","confirmation-overlay",4,"ngIf"],["alt","Image","width","50",3,"src"],[1,"btn-group"],["data-toggle","modal","data-target","#exampleModal",1,"btn","btn-sm","btn-success",3,"click"],[1,"fas","fa-edit"],[1,"btn","btn-sm","btn-danger",3,"click"],[1,"fas","fa-trash"],["colspan","10",1,"text-center"],[1,"alert","alert-success"],[1,"confirmation-overlay"],[1,"confirmation-box"],[1,"text-center"],[1,"btn","btn-danger","mr-2",3,"click"],[1,"btn","btn-secondary",3,"click"]],template:function(e,t){if(1&e){const e=m.EpF();m.TgZ(0,"div",0),m.TgZ(1,"h1",1),m._uU(2,"Liste des Produits"),m.qZA(),m.TgZ(3,"div",2),m.TgZ(4,"div",3),m.TgZ(5,"div",4),m.TgZ(6,"div",5),m.TgZ(7,"span",6),m._uU(8,"Produit"),m.qZA(),m.qZA(),m.TgZ(9,"input",7),m.NdJ("ngModelChange",function(e){return t.searchTerm=e})("input",function(){return t.onSearch(t.searchTerm)}),m.qZA(),m.TgZ(10,"div",8),m.TgZ(11,"button",9),m._UZ(12,"i",10),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.TgZ(13,"div",3),m.TgZ(14,"div",4),m.TgZ(15,"div",5),m.TgZ(16,"span",6),m._uU(17,"Cat\xe9gorie"),m.qZA(),m.qZA(),m.TgZ(18,"input",11),m.NdJ("ngModelChange",function(e){return t.categorySearchTerm=e})("input",function(){return t.onCategorySearch(t.categorySearchTerm)}),m.qZA(),m.TgZ(19,"div",8),m.TgZ(20,"button",9),m._UZ(21,"i",10),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.TgZ(22,"div",12),m.TgZ(23,"button",13),m._UZ(24,"i",14),m._uU(25,"Nouveau produit "),m.qZA(),m.qZA(),m.qZA(),m.TgZ(26,"div",15),m.TgZ(27,"div",16),m.TgZ(28,"table",17),m.TgZ(29,"thead"),m.TgZ(30,"tr"),m.TgZ(31,"th"),m._uU(32,"Image"),m.qZA(),m.TgZ(33,"th"),m._uU(34,"Nom"),m.qZA(),m.TgZ(35,"th"),m._uU(36,"Description"),m.qZA(),m.TgZ(37,"th"),m._uU(38,"Prix"),m.qZA(),m.TgZ(39,"th"),m._uU(40,"Stock"),m.qZA(),m.TgZ(41,"th"),m._uU(42,"Disponibilit\xe9"),m.qZA(),m.TgZ(43,"th"),m._uU(44,"Cat\xe9gorie"),m.qZA(),m.TgZ(45,"th"),m._uU(46,"Cr\xe9\xe9 le"),m.qZA(),m.TgZ(47,"th"),m._uU(48,"Mis \xe0 jour le"),m.qZA(),m.TgZ(49,"th"),m._uU(50,"Actions"),m.qZA(),m.qZA(),m.qZA(),m.TgZ(51,"tbody"),m.YNc(52,f,25,9,"tr",18),m.YNc(53,b,3,0,"tr",19),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.TgZ(54,"div",20),m.TgZ(55,"div",21),m.TgZ(56,"div",22),m.TgZ(57,"div",23),m.TgZ(58,"h5",24),m._uU(59," Mettre \xe0 jour le produit"),m.qZA(),m.TgZ(60,"button",25),m.TgZ(61,"span",26),m._uU(62,"\xd7"),m.qZA(),m.qZA(),m.qZA(),m.TgZ(63,"div",27),m.TgZ(64,"form",28,29),m.NdJ("ngSubmit",function(){m.CHM(e);const r=m.MAs(65);return t.updateProduct(r)}),m.TgZ(66,"div",30),m.TgZ(67,"label",31),m._uU(68,"Nom"),m.qZA(),m.TgZ(69,"input",32,33),m.NdJ("ngModelChange",function(e){return t.selectedProduct.name=e}),m.qZA(),m.qZA(),m.TgZ(71,"div",30),m.TgZ(72,"label",34),m._uU(73,"Description"),m.qZA(),m.TgZ(74,"input",35),m.NdJ("ngModelChange",function(e){return t.selectedProduct.description=e}),m.qZA(),m.qZA(),m.TgZ(75,"div",30),m.TgZ(76,"label",36),m._uU(77,"Prix"),m.qZA(),m.TgZ(78,"input",37),m.NdJ("ngModelChange",function(e){return t.selectedProduct.price=e}),m.qZA(),m.qZA(),m.TgZ(79,"div",30),m.TgZ(80,"label",38),m._uU(81,"Stock"),m.qZA(),m.TgZ(82,"input",39),m.NdJ("ngModelChange",function(e){return t.selectedProduct.stock=e}),m.qZA(),m.qZA(),m.TgZ(83,"div",30),m.TgZ(84,"label",40),m._uU(85,"Cat\xe9gorie"),m.qZA(),m.TgZ(86,"input",41),m.NdJ("ngModelChange",function(e){return t.selectedProduct.category.name=e}),m.qZA(),m.qZA(),m.YNc(87,q,2,1,"div",42),m.TgZ(88,"button",43),m._uU(89,"Mettre \xe0 jour le produit"),m.qZA(),m.qZA(),m.qZA(),m.TgZ(90,"div",44),m.TgZ(91,"button",45),m._uU(92,"Fermer"),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.YNc(93,y,9,0,"div",46)}if(2&e){const e=m.MAs(65);m.xp6(9),m.Q6J("ngModel",t.searchTerm),m.xp6(9),m.Q6J("ngModel",t.categorySearchTerm),m.xp6(34),m.Q6J("ngForOf",t.produits),m.xp6(1),m.Q6J("ngIf",0===t.produits.length),m.xp6(16),m.Q6J("ngModel",t.selectedProduct.name),m.xp6(5),m.Q6J("ngModel",t.selectedProduct.description),m.xp6(4),m.Q6J("ngModel",t.selectedProduct.price),m.xp6(4),m.Q6J("ngModel",t.selectedProduct.stock),m.xp6(4),m.Q6J("ngModel",t.selectedProduct.category.name),m.xp6(1),m.Q6J("ngIf",t.messageSuccess),m.xp6(1),m.Q6J("disabled",e.invalid),m.xp6(5),m.Q6J("ngIf",t.showConfirmModal)}},directives:[A.Fj,A.JJ,A.On,i.rH,o.sg,o.O5,A._Y,A.JL,A.F,A.Q7,A.wO,A.nD,A.wV],styles:[".confirmation-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#00000080;display:flex;justify-content:center;align-items:center;z-index:9999}.confirmation-box[_ngcontent-%COMP%]{background-color:#fff;padding:20px 30px;border-radius:8px;text-align:center;width:300px;box-shadow:0 5px 15px #0000004d}"]}),e})()}];let M=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=m.oAB({type:e}),e.\u0275inj=m.cJS({imports:[[i.Bz.forChild(x)],i.Bz]}),e})(),v=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=m.oAB({type:e}),e.\u0275inj=m.cJS({imports:[[o.ez,M,A.u5]]}),e})()}}]);