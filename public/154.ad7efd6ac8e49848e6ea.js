(self.webpackChunktest=self.webpackChunktest||[]).push([[154],{3154:(t,e,i)=>{"use strict";i.r(e),i.d(e,{ConfirmationcommandeModule:()=>m});var r=i(1116),d=i(3146),n=i(5614),a=i(5829);function s(t,e){if(1&t){const t=n.EpF();n.TgZ(0,"div",40),n.TgZ(1,"button",41),n.NdJ("click",function(){n.CHM(t);const e=n.oxw(2);return e.cancelOrder(e.orderDetails._id)}),n._uU(2," Annuler la commande "),n.qZA(),n.qZA()}}function o(t,e){if(1&t&&(n.TgZ(0,"div",42),n.TgZ(1,"div",43),n.TgZ(2,"div",44),n.TgZ(3,"div",45),n._UZ(4,"img",46),n.qZA(),n.TgZ(5,"div",47),n._uU(6),n.qZA(),n.qZA(),n.TgZ(7,"div",48),n.TgZ(8,"div"),n.TgZ(9,"span",49),n._uU(10,"Quantit\xe9: "),n.TgZ(11,"span",21),n._uU(12),n.qZA(),n.qZA(),n.qZA(),n.TgZ(13,"div"),n.TgZ(14,"span",49),n._uU(15,"Prix: "),n.TgZ(16,"span",21),n._uU(17),n.qZA(),n.qZA(),n.qZA(),n.TgZ(18,"div"),n.TgZ(19,"span",49),n._uU(20,"Total: "),n.TgZ(21,"span",21),n._uU(22),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.qZA()),2&t){const t=e.$implicit,i=n.oxw(2);n.xp6(4),n.s9C("alt",t.product.name),n.Q6J("src",t.product.image,n.LSH),n.xp6(2),n.Oqu(t.product.name),n.xp6(6),n.Oqu(t.quantity),n.xp6(5),n.hij("",t.price,"DT"),n.xp6(5),n.hij("",i.calculateItemTotal(t),"DT")}}const l=function(t,e,i,r){return{"badge--processing":t,"badge--shipped":e,"badge--delivered":i,"badge--cancelled":r}};function p(t,e){if(1&t){const t=n.EpF();n.TgZ(0,"div",15),n.TgZ(1,"div",16),n.TgZ(2,"h1",17),n._uU(3,"Confirmation de commande"),n.qZA(),n.TgZ(4,"div",18),n.TgZ(5,"div",19),n.TgZ(6,"div"),n.TgZ(7,"span",20),n._uU(8,"Merci pour votre commande!"),n.qZA(),n.TgZ(9,"div",21),n._uU(10),n.qZA(),n.TgZ(11,"div",22),n._uU(12),n.ALo(13,"date"),n.qZA(),n.qZA(),n.TgZ(14,"div"),n.TgZ(15,"span",23),n._uU(16),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.TgZ(17,"div",24),n.TgZ(18,"div",16),n.TgZ(19,"h2",25),n._uU(20,"Informations de livraison"),n.qZA(),n.TgZ(21,"div",12),n.TgZ(22,"div",26),n.TgZ(23,"div",27),n.TgZ(24,"div",28),n.TgZ(25,"h2",29),n._uU(26,"Adresse de livraison"),n.qZA(),n.TgZ(27,"span",30),n._uU(28),n.qZA(),n.TgZ(29,"span",30),n._uU(30),n.qZA(),n.TgZ(31,"span",30),n._uU(32),n.qZA(),n.TgZ(33,"span",30),n._uU(34),n.qZA(),n.TgZ(35,"span",30),n._uU(36),n.qZA(),n.TgZ(37,"span",30),n._uU(38),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.TgZ(39,"div",26),n.TgZ(40,"div",27),n.TgZ(41,"div",28),n.TgZ(42,"h2",29),n._uU(43,"M\xe9thode de paiement"),n.qZA(),n.TgZ(44,"span",30),n._uU(45),n.qZA(),n.YNc(46,s,3,0,"div",31),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.TgZ(47,"div",27),n.TgZ(48,"div",16),n.TgZ(49,"h2",25),n._uU(50,"Produits command\xe9s"),n.qZA(),n.TgZ(51,"div",32),n.YNc(52,o,23,6,"div",33),n.qZA(),n.qZA(),n.qZA(),n.TgZ(53,"div",34),n.TgZ(54,"div",16),n.TgZ(55,"h2",25),n._uU(56,"R\xe9sum\xe9 de la commande"),n.qZA(),n.TgZ(57,"div",35),n.TgZ(58,"div",36),n.TgZ(59,"table",37),n.TgZ(60,"tbody"),n.TgZ(61,"tr"),n.TgZ(62,"td"),n._uU(63,"Sous-total"),n.qZA(),n.TgZ(64,"td"),n._uU(65),n.qZA(),n.qZA(),n.TgZ(66,"tr"),n.TgZ(67,"td"),n._uU(68,"Livraison"),n.qZA(),n.TgZ(69,"td"),n._uU(70,"Gratuit"),n.qZA(),n.qZA(),n.TgZ(71,"tr"),n.TgZ(72,"td"),n._uU(73,"TOTAL TTC"),n.qZA(),n.TgZ(74,"td"),n._uU(75),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.TgZ(76,"div",18),n.TgZ(77,"a",38),n._uU(78," CONTINUER MES ACHATS "),n.qZA(),n.TgZ(79,"button",39),n.NdJ("click",function(){return n.CHM(t),n.oxw().printInvoice()}),n._uU(80," Imprimer la facture "),n.qZA(),n.qZA(),n.qZA(),n.qZA()}if(2&t){const t=n.oxw();n.xp6(10),n.hij("Commande #",t.orderDetails._id,""),n.xp6(2),n.hij(" Plac\xe9e le ",n.xi3(13,18,t.orderDetails.createdAt,"dd MMM yyyy \xe0 HH:mm")," "),n.xp6(3),n.Q6J("ngClass",n.l5B(21,l,"En traitement"===t.orderDetails.status,"Exp\xe9di\xe9e"===t.orderDetails.status,"Livr\xe9e"===t.orderDetails.status,"annul\xe9"===t.orderDetails.status)),n.xp6(1),n.hij(" ",t.orderDetails.status," "),n.xp6(12),n.AsE("",t.orderDetails.shippingDetails.firstName," ",t.orderDetails.shippingDetails.lastName,""),n.xp6(2),n.Oqu(t.orderDetails.shippingDetails.address),n.xp6(2),n.lnq("",t.orderDetails.shippingDetails.city,", ",t.orderDetails.shippingDetails.state," ",t.orderDetails.shippingDetails.zipCode,""),n.xp6(2),n.Oqu(t.orderDetails.shippingDetails.country),n.xp6(2),n.Oqu(t.orderDetails.shippingDetails.phone),n.xp6(2),n.Oqu(t.orderDetails.shippingDetails.email),n.xp6(7),n.hij(" ",t.getPaymentMethodDisplay(t.orderDetails.paymentMethod)," "),n.xp6(1),n.Q6J("ngIf","en attente"===t.orderDetails.status||"En traitement"===t.orderDetails.status),n.xp6(6),n.Q6J("ngForOf",t.orderDetails.items),n.xp6(13),n.hij("",t.orderDetails.totalAmount," DT"),n.xp6(10),n.hij("",t.orderDetails.totalAmount," DT")}}function c(t,e){1&t&&(n.TgZ(0,"div",15),n.TgZ(1,"div",16),n.TgZ(2,"h1",17),n._uU(3,"Chargement des d\xe9tails de la commande..."),n.qZA(),n.qZA(),n.qZA())}function g(t,e){if(1&t&&(n.TgZ(0,"div",15),n.TgZ(1,"div",16),n.TgZ(2,"h1",17),n._uU(3,"Erreur"),n.qZA(),n.TgZ(4,"p",20),n._uU(5),n.qZA(),n.TgZ(6,"a",50),n._uU(7,"Retour \xe0 l'accueil"),n.qZA(),n.qZA(),n.qZA()),2&t){const t=n.oxw();n.xp6(5),n.Oqu(t.error)}}const u=[{path:"",component:(()=>{class t{constructor(t,e,i){this.route=t,this.router=e,this.commandeService=i,this.orderId="",this.orderDetails=null,this.error=""}ngOnInit(){this.route.params.subscribe(t=>{this.orderId=t.id,this.orderId?this.loadOrderDetails():this.error="Num\xe9ro de commande non sp\xe9cifi\xe9"})}loadOrderDetails(){this.commandeService.getOrderDetails(this.orderId).subscribe(t=>{t.success?this.orderDetails=t.order:this.error="Impossible de charger les d\xe9tails de commande"},t=>{console.error("Error loading order details:",t),this.error="Une erreur est survenue lors du chargement des d\xe9tails de commande"})}getPaymentMethodDisplay(t){switch(t){case"cash-on-delivery":case"cash":return"Paiement \xe0 la livraison";case"direct-bank-transfer":case"bank-transfer":return"Virement bancaire direct";case"pay-with-card":case"card":return"Carte de cr\xe9dit / d\xe9bit";case"pay-pal":case"paypal":return"PayPal";default:return t}}cancelOrder(t){confirm("\xcates-vous s\xfbr de vouloir annuler cette commande?")&&this.commandeService.cancelOrder(t).subscribe(t=>{t.success?(alert("Commande annul\xe9e avec succ\xe8s"),this.loadOrderDetails()):alert(t.message||"\xc9chec de l'annulation de la commande")},t=>{console.error("Error cancelling order:",t),alert("Une erreur est survenue lors de l'annulation de la commande")})}calculateItemTotal(t){return t.quantity*(t.price||t.product&&t.product.price||0)}printInvoice(){let t=this.prepareInvoiceForPrinting(),e=document.body.innerHTML;document.body.innerHTML=t,window.print(),document.body.innerHTML=e,location.reload()}prepareInvoiceForPrinting(){return`\n    <div class="invoice-print" style="padding: 20px; font-family: Arial, sans-serif;">\n      <div style="text-align: center; margin-bottom: 20px;">\n        <h1>FACTURE</h1>\n        <p>Commande #${this.orderDetails._id}</p>\n        <p>Date: ${new Date(this.orderDetails.createdAt).toLocaleDateString("fr-FR")}</p>\n      </div>\n      \n      <div style="margin-bottom: 20px;">\n        <div style="float: left; width: 50%;">\n          <h3>Adresse de livraison</h3>\n          <p>${this.orderDetails.shippingDetails.firstName} ${this.orderDetails.shippingDetails.lastName}</p>\n          <p>${this.orderDetails.shippingDetails.address}</p>\n          <p>${this.orderDetails.shippingDetails.city}, ${this.orderDetails.shippingDetails.state} ${this.orderDetails.shippingDetails.zipCode}</p>\n          <p>${this.orderDetails.shippingDetails.country}</p>\n          <p>T\xe9l: ${this.orderDetails.shippingDetails.phone}</p>\n          <p>Email: ${this.orderDetails.shippingDetails.email}</p>\n        </div>\n        <div style="float: right; width: 50%;">\n          <h3>Informations de paiement</h3>\n          <p>M\xe9thode: ${this.getPaymentMethodDisplay(this.orderDetails.paymentMethod)}</p>\n        </div>\n        <div style="clear: both;"></div>\n      </div>\n      \n      <table style="width: 100%; border-collapse: collapse; margin-bottom: 20px;">\n        <thead>\n          <tr style="background-color: #f2f2f2;">\n            <th style="padding: 10px; border: 1px solid #ddd; text-align: left;">Produit</th>\n            <th style="padding: 10px; border: 1px solid #ddd; text-align: left;">Prix</th>\n            <th style="padding: 10px; border: 1px solid #ddd; text-align: left;">Quantit\xe9</th>\n            <th style="padding: 10px; border: 1px solid #ddd; text-align: left;">Total</th>\n          </tr>\n        </thead>\n        <tbody>\n          ${this.orderDetails.items.map(t=>`\n            <tr>\n              <td style="padding: 10px; border: 1px solid #ddd;">${t.product.name}</td>\n              <td style="padding: 10px; border: 1px solid #ddd;">${t.price} DT</td>\n              <td style="padding: 10px; border: 1px solid #ddd;">${t.quantity}</td>\n              <td style="padding: 10px; border: 1px solid #ddd;">${this.calculateItemTotal(t)} DT</td>\n            </tr>\n          `).join("")}\n        </tbody>\n      </table>\n      \n      <div style="margin-left: auto; width: 300px;">\n        <table style="width: 100%; border-collapse: collapse;">\n          <tr>\n            <td style="padding: 10px; border: 1px solid #ddd;"><strong>Sous-total</strong></td>\n            <td style="padding: 10px; border: 1px solid #ddd; text-align: right;">${this.orderDetails.totalAmount} DT</td>\n          </tr>\n          <tr>\n            <td style="padding: 10px; border: 1px solid #ddd;"><strong>Livraison</strong></td>\n            <td style="padding: 10px; border: 1px solid #ddd; text-align: right;">Gratuit</td>\n          </tr>\n          <tr>\n            <td style="padding: 10px; border: 1px solid #ddd;"><strong>TOTAL TTC</strong></td>\n            <td style="padding: 10px; border: 1px solid #ddd; text-align: right;">${this.orderDetails.totalAmount} DT</td>\n          </tr>\n        </table>\n      </div>\n      \n      <div style="margin-top: 40px; text-align: center;">\n        <p>Merci pour votre commande!</p>\n      </div>\n    </div>\n  `}}return t.\u0275fac=function(e){return new(e||t)(n.Y36(d.gz),n.Y36(d.F0),n.Y36(a.I))},t.\u0275cmp=n.Xpm({type:t,selectors:[["app-confirmationcommande"]],decls:21,vars:3,consts:[[1,"app-content"],[1,"u-s-p-y-60"],[1,"section__content"],[1,"container"],[1,"breadcrumb"],[1,"breadcrumb__wrap"],[1,"breadcrumb__list"],[1,"has-separator"],["routerLink","/accueil"],[1,"is-marked"],["routerLink","/commande"],[1,"u-s-p-b-60"],[1,"row"],[1,"col-lg-12"],["class","dash__box dash__box--shadow dash__box--radius dash__box--bg-white",4,"ngIf"],[1,"dash__box","dash__box--shadow","dash__box--radius","dash__box--bg-white"],[1,"dash__pad-2"],[1,"dash__h1","u-s-m-b-14"],[1,"u-s-m-b-30"],[1,"dash-l-r"],[1,"dash__text","u-s-m-b-30"],[1,"manage-o__text-2","u-c-secondary"],[1,"manage-o__text","u-c-silver"],[1,"manage-o__badge",3,"ngClass"],[1,"dash__box","u-s-m-b-30"],[1,"dash__h2","u-s-m-b-10"],[1,"col-lg-6"],[1,"dash__box"],[1,"dash__pad-3"],[1,"dash__h2","u-s-m-b-8"],[1,"dash__text-2"],["class","u-s-m-t-30",4,"ngIf"],[1,"m-order__list"],["class","m-order__item",4,"ngFor","ngForOf"],[1,"dash__box","u-s-m-t-30"],[1,"o-summary__section","u-s-m-b-30"],[1,"o-summary__box"],[1,"o-summary__table"],["href","boutiquegrid",1,"btn","btn--e-brand-b-2"],[1,"btn","btn-primary",2,"margin-left","5px",3,"click"],[1,"u-s-m-t-30"],[1,"btn","btn--e-transparent-brand-b-2",3,"click"],[1,"m-order__item"],[1,"manage-o__description"],[1,"description__container"],[1,"description__img-wrap"],[1,"u-img-fluid",3,"src","alt"],[1,"description-title"],[1,"description__info-wrap"],[1,"manage-o__text-2","u-c-silver"],["routerLink","/accueil",1,"btn","btn--e-brand-b-2"]],template:function(t,e){1&t&&(n.TgZ(0,"div",0),n.TgZ(1,"div",1),n.TgZ(2,"div",2),n.TgZ(3,"div",3),n.TgZ(4,"div",4),n.TgZ(5,"div",5),n.TgZ(6,"ul",6),n.TgZ(7,"li",7),n.TgZ(8,"a",8),n._uU(9,"Accueil"),n.qZA(),n.qZA(),n.TgZ(10,"li",9),n.TgZ(11,"a",10),n._uU(12,"Confirmation de commande"),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.TgZ(13,"div",11),n.TgZ(14,"div",2),n.TgZ(15,"div",3),n.TgZ(16,"div",12),n.TgZ(17,"div",13),n.YNc(18,p,81,26,"div",14),n.YNc(19,c,4,0,"div",14),n.YNc(20,g,8,1,"div",14),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.qZA()),2&t&&(n.xp6(18),n.Q6J("ngIf",e.orderDetails),n.xp6(1),n.Q6J("ngIf",!e.orderDetails&&!e.error),n.xp6(1),n.Q6J("ngIf",e.error))},directives:[d.yS,r.O5,r.mk,r.sg],pipes:[r.uU],styles:["@media print{.invoice-print[_ngcontent-%COMP%]{font-size:12pt}.invoice-print[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:18pt}.invoice-print[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:14pt}.no-print[_ngcontent-%COMP%]{display:none!important}}"]}),t})()}];let Z=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=n.oAB({type:t}),t.\u0275inj=n.cJS({imports:[[d.Bz.forChild(u)],d.Bz]}),t})(),m=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=n.oAB({type:t}),t.\u0275inj=n.cJS({imports:[[r.ez,Z]]}),t})()}}]);