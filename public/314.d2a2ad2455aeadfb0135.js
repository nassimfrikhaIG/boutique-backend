(self.webpackChunktest=self.webpackChunktest||[]).push([[314],{1314:(e,r,s)=>{"use strict";s.r(r),s.d(r,{ForgotpasswordModule:()=>S});var t=s(1116),i=s(9076),o=s(1462),n=s(8619),a=s(1225),u=s(7727),l=s(2693);let d=(()=>{class e{constructor(e){this.http=e,this.apiUrl="http://localhost:3000"}forgotPassword(e){return this.http.post(`${this.apiUrl}/forgot-password`,{email:e}).pipe((0,u.K)(this.handleError))}verifyResetToken(e){return this.http.get(`${this.apiUrl}/reset-password/${e}`).pipe((0,u.K)(this.handleError))}resetPassword(e,r){return this.http.post(`${this.apiUrl}/reset-password/${e}`,{password:r}).pipe((0,u.K)(this.handleError))}handleError(e){var r,s;let t="";return t=e.error instanceof ErrorEvent?`Erreur: ${e.error.message}`:0===e.status?"Connexion au serveur impossible. V\xe9rifiez votre connexion internet.":404===e.status?"Ressource non trouv\xe9e.":400===e.status?(null===(r=e.error)||void 0===r?void 0:r.error)||"Requ\xeate invalide.":500===e.status?"Erreur serveur. Veuillez r\xe9essayer plus tard.":`Code d'erreur: ${e.status}, Message: ${(null===(s=e.error)||void 0===s?void 0:s.error)||e.message}`,console.error(t),(0,a._)(()=>e)}}return e.\u0275fac=function(r){return new(r||e)(n.LFG(l.eN))},e.\u0275prov=n.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function c(e,r){if(1&e&&(n.TgZ(0,"div",34),n._uU(1),n.qZA()),2&e){const e=n.oxw(2);n.xp6(1),n.hij(" ",e.successMessage," ")}}function g(e,r){if(1&e&&(n.TgZ(0,"div",35),n._uU(1),n.qZA()),2&e){const e=n.oxw(2);n.xp6(1),n.hij(" ",e.errorMessage," ")}}function p(e,r){1&e&&(n.TgZ(0,"div"),n._uU(1,"L'adresse e-mail est obligatoire"),n.qZA())}function m(e,r){1&e&&(n.TgZ(0,"div"),n._uU(1,"L'adresse e-mail doit \xeatre valide"),n.qZA())}function Z(e,r){if(1&e&&(n.TgZ(0,"div",36),n.YNc(1,p,2,0,"div",21),n.YNc(2,m,2,0,"div",21),n.qZA()),2&e){const e=n.oxw(2);n.xp6(1),n.Q6J("ngIf",e.emailFormControls.email.errors.required),n.xp6(1),n.Q6J("ngIf",e.emailFormControls.email.errors.email)}}function v(e,r){1&e&&n._UZ(0,"span",37)}const f=function(e){return{"is-invalid":e}};function h(e,r){if(1&e){const e=n.EpF();n.TgZ(0,"div"),n.TgZ(1,"h1",22),n._uU(2,"R\xc9INITIALISATION DU MOT DE PASSE"),n.qZA(),n.TgZ(3,"span",23),n._uU(4,"Entrez votre adresse e-mail ci-dessous et nous vous enverrons un lien pour r\xe9initialiser votre mot de passe."),n.qZA(),n.YNc(5,c,2,1,"div",24),n.YNc(6,g,2,1,"div",25),n.TgZ(7,"form",26),n.NdJ("ngSubmit",function(){return n.CHM(e),n.oxw().onForgotSubmit()}),n.TgZ(8,"div",27),n.TgZ(9,"label",28),n._uU(10,"E-MAIL *"),n.qZA(),n._UZ(11,"input",29),n.YNc(12,Z,3,2,"div",30),n.qZA(),n.TgZ(13,"div",27),n.TgZ(14,"button",31),n.YNc(15,v,1,0,"span",32),n._uU(16," ENVOYER "),n.qZA(),n.qZA(),n.TgZ(17,"div",27),n.TgZ(18,"a",33),n._uU(19,"Retour \xe0 la connexion"),n.qZA(),n.qZA(),n.qZA(),n.qZA()}if(2&e){const e=n.oxw();n.xp6(5),n.Q6J("ngIf",e.successMessage),n.xp6(1),n.Q6J("ngIf",e.errorMessage),n.xp6(1),n.Q6J("formGroup",e.emailForm),n.xp6(4),n.Q6J("ngClass",n.VKq(7,f,e.submitted&&e.emailFormControls.email.errors)),n.xp6(1),n.Q6J("ngIf",e.submitted&&e.emailFormControls.email.errors),n.xp6(2),n.Q6J("disabled",e.loading),n.xp6(1),n.Q6J("ngIf",e.loading)}}function q(e,r){1&e&&(n.TgZ(0,"div"),n.TgZ(1,"div",38),n.TgZ(2,"div",39),n.TgZ(3,"span",40),n._uU(4,"Chargement..."),n.qZA(),n.qZA(),n.qZA(),n.TgZ(5,"p",41),n._uU(6,"V\xe9rification du lien de r\xe9initialisation..."),n.qZA(),n.qZA())}function A(e,r){if(1&e&&(n.TgZ(0,"div",34),n._uU(1),n.TgZ(2,"div",42),n.TgZ(3,"small"),n._uU(4,"Vous serez redirig\xe9 vers la page de connexion dans quelques secondes..."),n.qZA(),n.qZA(),n.qZA()),2&e){const e=n.oxw(2);n.xp6(1),n.hij(" ",e.successMessage," ")}}function T(e,r){1&e&&(n.TgZ(0,"div",44),n.TgZ(1,"a",10),n._uU(2,"Demander un nouveau lien"),n.qZA(),n.qZA())}function x(e,r){if(1&e&&(n.TgZ(0,"div",35),n._uU(1),n.YNc(2,T,3,0,"div",43),n.qZA()),2&e){const e=n.oxw(2);n.xp6(1),n.hij(" ",e.errorMessage," "),n.xp6(1),n.Q6J("ngIf",!e.tokenValid)}}function b(e,r){1&e&&(n.TgZ(0,"div"),n._uU(1,"Le mot de passe est requis"),n.qZA())}function w(e,r){1&e&&(n.TgZ(0,"div"),n._uU(1,"Le mot de passe doit contenir au moins 6 caract\xe8res"),n.qZA())}function _(e,r){if(1&e&&(n.TgZ(0,"div",36),n.YNc(1,b,2,0,"div",21),n.YNc(2,w,2,0,"div",21),n.qZA()),2&e){const e=n.oxw(3);n.xp6(1),n.Q6J("ngIf",e.resetFormControls.password.errors.required),n.xp6(1),n.Q6J("ngIf",e.resetFormControls.password.errors.minlength)}}function U(e,r){1&e&&(n.TgZ(0,"div"),n._uU(1,"La confirmation du mot de passe est requise"),n.qZA())}function I(e,r){1&e&&(n.TgZ(0,"div"),n._uU(1,"Les mots de passe ne correspondent pas"),n.qZA())}function E(e,r){if(1&e&&(n.TgZ(0,"div",36),n.YNc(1,U,2,0,"div",21),n.YNc(2,I,2,0,"div",21),n.qZA()),2&e){const e=n.oxw(3);n.xp6(1),n.Q6J("ngIf",e.resetFormControls.confirmPassword.errors.required),n.xp6(1),n.Q6J("ngIf",e.resetFormControls.confirmPassword.errors.mustMatch)}}function C(e,r){1&e&&n._UZ(0,"span",37)}function M(e,r){if(1&e){const e=n.EpF();n.TgZ(0,"div"),n.TgZ(1,"span",23),n._uU(2,"Cr\xe9ez un nouveau mot de passe pour "),n.TgZ(3,"strong"),n._uU(4),n.qZA(),n._uU(5,"."),n.qZA(),n.TgZ(6,"form",26),n.NdJ("ngSubmit",function(){return n.CHM(e),n.oxw(2).onResetSubmit()}),n.TgZ(7,"div",27),n.TgZ(8,"label",45),n._uU(9,"NOUVEAU MOT DE PASSE *"),n.qZA(),n._UZ(10,"input",46),n.YNc(11,_,3,2,"div",30),n.qZA(),n.TgZ(12,"div",27),n.TgZ(13,"label",47),n._uU(14,"CONFIRMER LE MOT DE PASSE *"),n.qZA(),n._UZ(15,"input",48),n.YNc(16,E,3,2,"div",30),n.qZA(),n.TgZ(17,"div",27),n.TgZ(18,"button",31),n.YNc(19,C,1,0,"span",32),n._uU(20," R\xc9INITIALISER LE MOT DE PASSE "),n.qZA(),n.qZA(),n.TgZ(21,"div",27),n.TgZ(22,"a",33),n._uU(23,"Annuler"),n.qZA(),n.qZA(),n.qZA(),n.qZA()}if(2&e){const e=n.oxw(2);n.xp6(4),n.Oqu(e.userEmail),n.xp6(2),n.Q6J("formGroup",e.resetForm),n.xp6(4),n.Q6J("ngClass",n.VKq(8,f,e.submitted&&e.resetFormControls.password.errors)),n.xp6(1),n.Q6J("ngIf",e.submitted&&e.resetFormControls.password.errors),n.xp6(4),n.Q6J("ngClass",n.VKq(10,f,e.submitted&&e.resetFormControls.confirmPassword.errors)),n.xp6(1),n.Q6J("ngIf",e.submitted&&e.resetFormControls.confirmPassword.errors),n.xp6(2),n.Q6J("disabled",e.loading),n.xp6(1),n.Q6J("ngIf",e.loading)}}function k(e,r){if(1&e&&(n.TgZ(0,"div"),n.TgZ(1,"h1",22),n._uU(2,"NOUVEAU MOT DE PASSE"),n.qZA(),n.YNc(3,q,7,0,"div",21),n.YNc(4,A,5,1,"div",24),n.YNc(5,x,3,2,"div",25),n.YNc(6,M,24,12,"div",21),n.qZA()),2&e){const e=n.oxw();n.xp6(3),n.Q6J("ngIf",e.loading),n.xp6(1),n.Q6J("ngIf",e.successMessage),n.xp6(1),n.Q6J("ngIf",e.errorMessage),n.xp6(1),n.Q6J("ngIf",e.tokenValid&&!e.loading)}}let F=(()=>{class e{constructor(e,r,s,t){this.formBuilder=e,this.route=r,this.router=s,this.clientService=t,this.submitted=!1,this.loading=!1,this.errorMessage="",this.successMessage="",this.currentStep="forgot",this.token="",this.tokenValid=!1,this.userEmail="",this.emailForm=this.formBuilder.group({email:["",[o.kI.required,o.kI.email]]}),this.resetForm=this.formBuilder.group({password:["",[o.kI.required,o.kI.minLength(6)]],confirmPassword:["",o.kI.required]},{validator:this.mustMatch("password","confirmPassword")})}ngOnInit(){this.route.params.subscribe(e=>{e.token&&(this.token=e.token,this.currentStep="reset",this.verifyToken())})}verifyToken(){this.loading=!0,this.errorMessage="",this.clientService.verifyResetToken(this.token).subscribe({next:e=>{this.loading=!1,this.tokenValid=!0,this.userEmail=e.email},error:e=>{var r;this.loading=!1,this.tokenValid=!1,this.errorMessage=404===e.status?"Ce lien de r\xe9initialisation est invalide ou a expir\xe9":0===e.status?"Impossible de se connecter au serveur. V\xe9rifiez votre connexion internet.":(null===(r=e.error)||void 0===r?void 0:r.error)||"Une erreur est survenue lors de la v\xe9rification du token",console.error("Erreur lors de la v\xe9rification du token:",e)}})}mustMatch(e,r){return s=>{const t=s.controls[r];t.errors&&!t.errors.mustMatch||t.setErrors(s.controls[e].value!==t.value?{mustMatch:!0}:null)}}get emailFormControls(){return this.emailForm.controls}get resetFormControls(){return this.resetForm.controls}onForgotSubmit(){if(this.submitted=!0,this.errorMessage="",this.successMessage="",this.emailForm.invalid)return;this.loading=!0;const e=this.emailFormControls.email.value;console.log("Envoi de la demande de r\xe9initialisation pour:",e),this.clientService.forgotPassword(e).subscribe({next:e=>{this.loading=!1,this.successMessage=e.message||"Si un compte est associ\xe9 \xe0 cette adresse email, un lien de r\xe9initialisation a \xe9t\xe9 envoy\xe9.",this.emailForm.reset(),this.submitted=!1},error:e=>{var r,s;this.loading=!1,this.errorMessage=400===e.status?(null===(r=e.error)||void 0===r?void 0:r.error)||"Veuillez v\xe9rifier le format de votre adresse email.":0===e.status?"Impossible de se connecter au serveur. V\xe9rifiez votre connexion internet.":500===e.status?"Le serveur a rencontr\xe9 un probl\xe8me lors de l'envoi de l'email. Veuillez r\xe9essayer plus tard.":(null===(s=e.error)||void 0===s?void 0:s.error)||"Une erreur est survenue. Veuillez r\xe9essayer.",console.error("Erreur lors de la demande de r\xe9initialisation:",e)}})}onResetSubmit(){this.submitted=!0,this.errorMessage="",this.successMessage="",this.resetForm.invalid||(this.loading=!0,this.clientService.resetPassword(this.token,this.resetFormControls.password.value).subscribe({next:e=>{this.loading=!1,this.successMessage=e.message||"Votre mot de passe a \xe9t\xe9 r\xe9initialis\xe9 avec succ\xe8s.",setTimeout(()=>{this.router.navigate(["/login"])},3e3)},error:e=>{var r,s;this.loading=!1,this.errorMessage=400===e.status?(null===(r=e.error)||void 0===r?void 0:r.error)||"Le mot de passe ne r\xe9pond pas aux exigences de s\xe9curit\xe9.":404===e.status?"Ce lien de r\xe9initialisation est invalide ou a expir\xe9.":0===e.status?"Impossible de se connecter au serveur. V\xe9rifiez votre connexion internet.":(null===(s=e.error)||void 0===s?void 0:s.error)||"Une erreur est survenue lors de la r\xe9initialisation du mot de passe.",console.error("Erreur lors de la r\xe9initialisation du mot de passe:",e)}}))}}return e.\u0275fac=function(r){return new(r||e)(n.Y36(o.qu),n.Y36(i.gz),n.Y36(i.F0),n.Y36(d))},e.\u0275cmp=n.Xpm({type:e,selectors:[["app-forgotpassword"]],decls:29,vars:2,consts:[[1,"app-content"],[1,"u-s-p-y-60"],[1,"section__content"],[1,"container"],[1,"breadcrumb"],[1,"breadcrumb__wrap"],[1,"breadcrumb__list"],[1,"has-separator"],["routerLink","/"],[1,"is-marked"],["routerLink","/password-reset"],[1,"u-s-p-b-60"],[1,"section__intro","u-s-m-b-60"],[1,"row"],[1,"col-lg-12"],[1,"section__text-wrap"],[1,"section__heading","u-c-secondary"],[1,"row","row--center"],[1,"col-lg-6","col-md-8","u-s-m-b-30"],[1,"l-f-o"],[1,"l-f-o__pad-box"],[4,"ngIf"],[1,"gl-h1"],[1,"gl-text","u-s-m-b-30"],["class","alert alert-success",4,"ngIf"],["class","alert alert-danger",4,"ngIf"],[1,"l-f-o__form",3,"formGroup","ngSubmit"],[1,"u-s-m-b-30"],["for","reset-email",1,"gl-label"],["type","email","id","reset-email","formControlName","email","placeholder","Entrez votre e-mail",1,"input-text","input-text--primary-style",3,"ngClass"],["class","invalid-feedback",4,"ngIf"],["type","submit",1,"btn","btn--e-transparent-brand-b-2",3,"disabled"],["class","spinner-border spinner-border-sm","role","status","aria-hidden","true",4,"ngIf"],["routerLink","/login",1,"gl-link"],[1,"alert","alert-success"],[1,"alert","alert-danger"],[1,"invalid-feedback"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm"],[1,"d-flex","justify-content-center"],["role","status",1,"spinner-border"],[1,"visually-hidden"],[1,"text-center","mt-2"],[1,"mt-2"],["class","text-center mt-3",4,"ngIf"],[1,"text-center","mt-3"],["for","new-password",1,"gl-label"],["type","password","id","new-password","formControlName","password","placeholder","Entrez le nouveau mot de passe",1,"input-text","input-text--primary-style",3,"ngClass"],["for","confirm-password",1,"gl-label"],["type","password","id","confirm-password","formControlName","confirmPassword","placeholder","Confirmez le mot de passe",1,"input-text","input-text--primary-style",3,"ngClass"]],template:function(e,r){1&e&&(n.TgZ(0,"div",0),n.TgZ(1,"div",1),n.TgZ(2,"div",2),n.TgZ(3,"div",3),n.TgZ(4,"div",4),n.TgZ(5,"div",5),n.TgZ(6,"ul",6),n.TgZ(7,"li",7),n.TgZ(8,"a",8),n._uU(9,"Accueil"),n.qZA(),n.qZA(),n.TgZ(10,"li",9),n.TgZ(11,"a",10),n._uU(12,"R\xe9initialisation"),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.TgZ(13,"div",11),n.TgZ(14,"div",12),n.TgZ(15,"div",3),n.TgZ(16,"div",13),n.TgZ(17,"div",14),n.TgZ(18,"div",15),n.TgZ(19,"h1",16),n._uU(20,"MOT DE PASSE OUBLI\xc9 ?"),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.TgZ(21,"div",2),n.TgZ(22,"div",3),n.TgZ(23,"div",17),n.TgZ(24,"div",18),n.TgZ(25,"div",19),n.TgZ(26,"div",20),n.YNc(27,h,20,9,"div",21),n.YNc(28,k,7,4,"div",21),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.qZA()),2&e&&(n.xp6(27),n.Q6J("ngIf","forgot"===r.currentStep),n.xp6(1),n.Q6J("ngIf","reset"===r.currentStep))},directives:[i.yS,t.O5,o._Y,o.JL,o.sg,o.Fj,o.JJ,o.u,t.mk],encapsulation:2}),e})();const J=[{path:"",component:F},{path:":token",component:F}];let N=(()=>{class e{}return e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=n.oAB({type:e}),e.\u0275inj=n.cJS({imports:[[i.Bz.forChild(J)],i.Bz]}),e})(),S=(()=>{class e{}return e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=n.oAB({type:e}),e.\u0275inj=n.cJS({imports:[[t.ez,N,i.Bz,o.u5,o.UX]]}),e})()}}]);